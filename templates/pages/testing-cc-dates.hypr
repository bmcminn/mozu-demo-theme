{% extends "page" %}

{% block title-tag-content %}{% firstof pageContext.metaTitle model.name %}  - {% parent %}{% endblock title-tag-content %}

{% block body-content %}

    <h2>CURRENT CC YEAR (STATIC)</h2>

<select name="cc-static" id="cc-static">
    <option></option>
    <option {% if model.expireYear == "2014" %}selected="selected"{% endif %} value="2014">2014</option>
    <option {% if model.expireYear == "2015" %}selected="selected"{% endif %} value="2015">2015</option>
    <option {% if model.expireYear == "2016" %}selected="selected"{% endif %} value="2016">2016</option>
    <option {% if model.expireYear == "2017" %}selected="selected"{% endif %} value="2017">2017</option>
    <option {% if model.expireYear == "2018" %}selected="selected"{% endif %} value="2018">2018</option>
    <option {% if model.expireYear == "2019" %}selected="selected"{% endif %} value="2019">2019</option>
    <option {% if model.expireYear == "2020" %}selected="selected"{% endif %} value="2020">2020</option>
    <option {% if model.expireYear == "2021" %}selected="selected"{% endif %} value="2021">2021</option>
    <option {% if model.expireYear == "2022" %}selected="selected"{% endif %} value="2022">2022</option>
    <option {% if model.expireYear == "2023" %}selected="selected"{% endif %} value="2023">2023</option>
    <option {% if model.expireYear == "2024" %}selected="selected"{% endif %} value="2024">2024</option>
</select>


    <h3>Source:</h3>

    <script src="https://gist.github.com/Mozu-CS/7b510b45b612558178ed.js?file=cc-year-static.twig"></script>


    <hr>


    <h2>NEW CC YEAR (DYNAMIC)</h2>

    <blockquote>
        SAUCE: <a href="https://www.chargesmart.com/blog/2012/07/the-mystery-behind-expiration-dates-on-credit-cards/">CC's should expire within 3 years from date of issue</a>
    </blockquote>

    {% with pageContext.now|date('Y') as currentYear %}

    <p>
        The current (dumb) way to build a CC year field is to statically type the years from 2014 - 2024.

        This is simplistic, invalid, and opens people up to potential security and usability issues.
    </p>

    <p>
        Per the <i>Sauce</i> link above, current Fraud and Loss prevention laws dictate that credit cards issued should only be valid for three (3) years.
    </p>

    <p>
        That said, the solution is to get the current year, as all years previous to {{ currentYear }} are now expired, and generate a list that is four years long. This covers all cards set to expire this year ({{ currentYear }}), but also covers cards that were issued later this year that expire after X months into three years from now.
    </p>
    {% endwith %}


    <h3>Working Example:</h3>

{% with pageContext.now|date('Y') as currentYear %}
{% with themeSettings.ccYears|default('0,1,2,3')|split(',') as ccYears %}
    {% partial_cache currentYear, ccYears %}
        <label for="cc-year-dynamic">CC Year: </label>
        <select name="cc-year-dynamic" id="cc-year-dynamic" required>
            <option>{{ themeSetting.blankOptionText|default('') }}</option>
            {% for year in ccYears %}
                <option value="{{ currentYear|add(year) }}"{% if model.expireYear == currentYear|add(year) %} selected="selected"{% endif %}>{{ currentYear|add(year) }}</option>
            {% endfor %}
        </select>
    {% endpartial_cache %}
{% endwith %}
{% endwith %}


    <h3>Source:</h3>

    <script src="https://gist.github.com/Mozu-CS/7b510b45b612558178ed.js?file=cc-year-automagic.twig"></script>

{% endblock body-content %}
